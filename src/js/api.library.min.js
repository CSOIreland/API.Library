var api=api||{};api.spinner={},api.spinner.count=0,api.spinner.progress={},api.spinner.progress.instance=null,api.spinner.progress.timeout=0,api.spinner.start=function(e=null){if(null!=e){$(e).find(".item-spinner").remove();var n=$("#spinner-holder").find(".item-spinner").clone();$(e).prepend($(n)),$(n).removeClass("d-none"),$(e).find(".item-spinner").show(),new ResizeObserver((()=>{$(e).find(n).find(".item-loader").css("margin-top",.5*$(e).height()-15)})).observe($(e)[0])}else api.spinner.count++||$("#spinner").show()},api.spinner.stop=function(e=null){null!=e?($(e).find(".item-spinner").find(".item-loader").addClass("d-none"),$(e).find(".item-spinner").remove()):(api.spinner.count&&api.spinner.count--,api.spinner.count||(api.spinner.progress.instance?(api.spinner.progress.stop(),setTimeout((function(){$("#spinner").fadeOut("slow")}),1e3)):$("#spinner").fadeOut("slow")))},api.spinner.progress.start=function(e){e&&(clearTimeout(api.spinner.progress.instance),api.spinner.progress.timeout=e,$("#spinner .progress").find("[name=bar]").css("width","1%").attr("aria-valuenow",1),$("#spinner .progress").find("[name=percentage]").text("1%"),$("#spinner .progress").show(),api.spinner.progress.setTimeout())},api.spinner.progress.stop=function(){clearTimeout(api.spinner.progress.instance),$("#spinner .progress").find("[name=bar]").css("width","100%").attr("aria-valuenow",100),$("#spinner .progress").find("[name=percentage]").text("100%"),$("#spinner .progress").fadeOut("slow")},api.spinner.progress.getTimeout=function(e,n){var a=e/n;return a=a/100*1*1e3},api.spinner.progress.setTimeout=function(){api.spinner.progress.timeout=Math.ceil(api.spinner.progress.timeout+api.spinner.progress.timeout/100*.5),api.spinner.progress.instance=setTimeout((function(){var e=Math.min(parseInt($("#spinner .progress").find("[name=bar]").attr("aria-valuenow"))+1,99);$("#spinner .progress").find("[name=bar]").css("width",e+"%").attr("aria-valuenow",e),$("#spinner .progress").find("[name=percentage]").text(e+"%"),api.spinner.progress.setTimeout()}),api.spinner.progress.timeout)},api.content={},api.content.params={},api.content.getParam=function(e){return api.content.params[e]},api.content.load=function(e,n,a,i){a=a||{},i=i||!1,!1!==new URI(n).is("relative")&&$.ajax({url:n,async:!1,success:function(n){api.content.params=a,i?$(e).append(n).promise().done((function(){api.content.params={}})):$(e).empty().html(n).promise().done((function(){api.content.params={}}))}})},api.content.navigate=function(e,n,a,i){a=a||null,i=i||null,!1!==new URI(n).is("relative")&&$(e).click((function(e){e.preventDefault(),$.ajax({url:n,async:!1,success:function(e){$("#body").hide().empty().html(e).fadeIn()}}),$("#navigation").find("*").removeClass("show"),$("#navigation").find("*").removeClass("active"),a&&$(a).addClass("active"),i&&$(i).addClass("active")}))},api.content.goTo=function(e,n,a,i){n=n||null,a=a||null,i=i||{},!1!==new URI(e).is("relative")&&($.ajax({url:e,async:!1,success:function(e){api.content.params=i,$("#body").hide().empty().html(e).fadeIn().promise().done((function(){api.content.params={}}))}}),$("#navigation").find("*").removeClass("show"),$("#navigation").find("*").removeClass("active"),n&&$(n).addClass("active"),a&&$(a).addClass("active"))},api.ajax={},api.ajax.callback=function(e,n,a){n=n||null,a=a||{};var i=window,o="";if("function"==typeof(o=i[e]))return jQuery.isEmptyObject(a)?o(n):o(n,a);for(var t=e.split("."),s=t.pop(),r=0;r<t.length;r++)i=i[t[r]];return!!i&&(o=i[s],jQuery.isEmptyObject(a)?o(n):o(n,a))},api.ajax.config=function(e,n,a,i){(a=a||{}).method=a.method||"GET",a.dataType=a.dataType||"json",a.jsonp=a.jsonp||!1,a.timeout=a.timeout||6e4,a.async=a.async||!1,ajaxParams={url:e,success:function(e){n(e)},error:function(n,a,o){console.log('An Internal Server has occurred: the configuration file "'+e+'" is missing or invalid.'),i&&i()}},$.extend(ajaxParams,a),$.ajax(ajaxParams)},api.ajax.jsonrpc={},api.ajax.jsonrpc.request=function(e,n,a,i,o,t,s,r,m=null,d=!1){a=a||{},i=i||null,t=t||null,o=o||null,s=s||null,(r=r||{}).method=r.method||"POST",r.dataType=r.dataType||"json",r.jsonp=r.jsonp||!1,r.timeout=r.timeout||18e4;var l=void 0!==r.async&&!r.async;r.async=!0;var p=Math.floor(999999999*Math.random())+1,c={jsonrpc:"2.0",method:n,params:a,id:p},u={url:e,data:JSON.stringify(c),xhrFields:{withCredentials:!0},success:function(e){if("json"!=r.dataType||e.id==p)if(e.error){if(!d){var n=null;e.error.data?$.isArray(e.error.data)&&e.error.data.length||$.isPlainObject(e.error.data)&&!$.isEmptyObject(e.error.data)?(n=$("<ul>",{class:"list-group"}),$.each(e.error.data,(function(e,a){var i=$("<li>",{class:"list-group-item",html:a.toString()});n.append(i)}))):n=e.error.data:n=e.error.message,api.modal.error(n)}t&&api.ajax.callback(t,e.error,s)}else void 0!==e.result?i&&api.ajax.callback(i,e.result,o):api.modal.exception("An unexpected error has occurred. Please try again.");else api.modal.exception("An invalid JSON-RPC Identifier has been detected. Please try again.")},error:function(e,n,a){t?api.ajax.callback(t,null,s):"Unauthorized"==a||api.modal.exception("A Server or Network Error has occurred. Please try again.")},complete:function(){l&&api.spinner.stop(m),$("#nav-loader").addClass("invisible"),$("body").css("cursor","default")}};$.extend(u,r);try{return $("#nav-loader").removeClass("invisible"),$("body").css("cursor","progress"),l&&api.spinner.start(m),api.cookie.session.extend(),$.ajax(u)}catch(e){return console.log(e),api.modal.exception("An unhandled Ajax exception has occurred. Please try again."),!1}},api.modal={},api.modal.confirm=function(e,n,a,i,o,t){var s;if("string"==typeof e)try{s=JSON.parse(e)}catch(n){s=e}else s=e;s.hasOwnProperty("title")?$("#modal-confirm").find("[name=message-text]").empty().html(s.title):$("#modal-confirm").find("[name=message-text]").empty().html(s),s.hasOwnProperty("message")?$("#modal-confirm").find("[name=message-content]").empty().html(s.message):$("#modal-confirm").find("[name=message-content]").empty();let r="";$("#modal-confirm").find("[name=confirm-btn]").removeClass(),"error"==i?(r="far fa-times-circle text-danger",$("#modal-confirm").find("[name=confirm-btn]").addClass("btn btn-danger text-light")):"question"==i?(r="fa fa-question-circle text-primary",$("#modal-confirm").find("[name=confirm]").addClass("btn border-primary btn-primary text-light")):(r="fa fa-info-circle text-warning",$("#modal-confirm").find("[name=confirm]").removeClass().addClass("btn btn-warning")),$("#modal-confirm").find("[name=icon-type]").removeClass().addClass(r+" fa-5x"),$("#modal-confirm").find("[name=confirm]").once("click",(function(){$("#modal-confirm").modal("hide").delay(100).queue((function(){n(a),$(this).dequeue()}))})),$("#modal-confirm").find("[name=cancel-confirm]").once("click",(function(){$("#modal-confirm").modal("hide").delay(100).queue((function(){null!=o&&o(t),$(this).dequeue()}))})),$("#modal-confirm").modal("show")},api.modal.success=function(e){var n;if("string"==typeof e)try{n=JSON.parse(e)}catch(a){n=e}else n=e;n.hasOwnProperty("title")?$("#modal-success").find("[name=message-text]").empty().html(n.title):$("#modal-success").find("[name=message-text]").empty().html(n),n.hasOwnProperty("message")?$("#modal-success").find("[name=message-content]").empty().html(n.message):$("#modal-success").find("[name=message-content]").empty(),$("#modal-success").find("[name=success]").once("click",(function(){$("#modal-success").modal("hide"),$(".modal-hidden").removeClass("d-none")})),$("#modal-success").on("hidden.bs.modal",(function(){$(".modal-hidden").removeClass("d-none")})),$("#modal-success").modal("show")},api.modal.error=function(e){var n;if("string"==typeof e)try{n=JSON.parse(e)}catch(a){n={title:e}}else n=e;Array.isArray(n)&&(n=n[0]),$("#modal-error").find("[name=message-content]").empty(),$("#modal-error").find("[name=more-info-content]").addClass("d-none"),"object"==typeof e?n.hasOwnProperty("title")?$("#modal-error").find("[name=message-text]").empty().html(n.title):$("#modal-error").find("[name=message-text]").empty().html(n):$("#modal-error").find("[name=message-text]").empty().html(n.title),n.hasOwnProperty("message")&&($("#modal-error").find("[name=message-content]").empty().html(n.message),$("#modal-error").find("[name=message-uuid]").empty().html(n.uuid)),$("#modal-error").find("[name=error]").once("click",(function(){$("#modal-error").modal("hide"),$(".modal-hidden").removeClass("d-none")})),$("#modal-error").on("hidden.bs.modal",(function(){$(".modal-hidden").removeClass("d-none")})),$("#modal-error").modal("show")},api.modal.information=function(e){var n;if("string"==typeof e)try{n=JSON.parse(e)}catch(a){n=e}else n=e;n.hasOwnProperty("title")?$("#modal-information").find("[name=message-text]").empty().html(n.title):$("#modal-information").find("[name=message-text]").empty().html(n),n.hasOwnProperty("message")?$("#modal-information").find("[name=message-content]").empty().html(n.message):$("#modal-information").find("[name=message-content]").empty(),$("#modal-information").find("[name=information]").once("click",(function(){$("#modal-information").modal("hide"),$(".modal-hidden").removeClass("d-none")})),$("#modal-information").on("hidden.bs.modal",(function(){$(".modal-hidden").removeClass("d-none")})),$("#modal-information").modal("show")},api.modal.warning=function(e){var n;if("string"==typeof e)try{n=JSON.parse(e)}catch(a){n=e}else n=e;n.hasOwnProperty("title")?$("#modal-warning").find("[name=message-text]").empty().html(n.title):$("#modal-warning").find("[name=message-text]").empty().html(n),n.hasOwnProperty("message")?$("#modal-warning").find("[name=message-content]").empty().html(n.message):$("#modal-warning").find("[name=message-content]").empty(),$("#modal-warning").find("[name=warning]").once("click",(function(){$("#modal-warning").modal("hide"),$(".modal-hidden").removeClass("d-none")})),$("#modal-warning").on("hidden.bs.modal",(function(){$(".modal-hidden").removeClass("d-none")})),$("#modal-warning").modal("show")},api.modal.exception=function(e){var n;if("string"==typeof e)try{n=JSON.parse(e)}catch(a){n=e}else n=e;n.hasOwnProperty("title")?$("#modal-exception").find("[name=message-text]").empty().html(n.title):$("#modal-exception").find("[name=message-text]").empty().html(n),n.hasOwnProperty("message")?$("#modal-exception").find("[name=message-content]").empty().html(n.message):$("#modal-exception").find("[name=message-content]").empty(),$("#modal-exception").find("[name=exception]").once("click",(function(){$("#modal-exception").modal("hide"),$(".modal-hidden").removeClass("d-none")})),$("#modal-exception").on("hidden.bs.modal",(function(){$(".modal-hidden").removeClass("d-none")})),$("#modal-exception").modal("show")},api.uri={},api.uri.parse=function(e){var n=new n(e);return n.parseQuery(uri.search())},api.uri.isParam=function(e,n){n=n||window.location.href;var a=new URI(n);return e in URI.parseQuery(a.search())},api.uri.getParam=function(e,n){n=n||window.location.href;var a=new URI(n),i=URI.parseQuery(a.search());return e in i&&i[e]},api.uri.getNoHeader=function(){return api.uri.isParam(C_API_URI_NOHEADER)},api.uri.getNoNavbar=function(){return api.uri.isParam(C_API_URI_NONAVBAR)},api.uri.getNoFooter=function(){return api.uri.isParam(C_API_URI_NOFOOTER)},api.uri.getBody=function(){return api.uri.getParam(C_API_URI_BODY)},api.cookie={},api.cookie.session={},api.cookie.session.data={length:null,expiry:null,logoutEndpoint:null,logoutMethod:null},api.cookie.session.options={path:"/",secure:"true",sameSite:"strict"},api.cookie.session.confirmExtension=function(){},api.cookie.session.start=function(e,n,a){var i=Math.round((new Date).getTime()/1e3);Cookies.setJSON(C_API_COOKIE_SESSION,$.extend(!0,{},api.cookie.session.data,{length:e,expiry:i+e,logoutEndpoint:n,logoutMethod:a}),api.cookie.session.options),window.setInterval(api.cookie.session.intervalRoutine,1e3)},api.cookie.session.extend=function(){var e=Cookies.getJSON(C_API_COOKIE_SESSION);if(e){var n=Math.round((new Date).getTime()/1e3);Cookies.setJSON(C_API_COOKIE_SESSION,$.extend(!0,{},e,{length:e.length,expiry:n+e.length}),api.cookie.session.options)}},api.cookie.session.end=function(e,n){e=e||null,n=n||null;var a=Cookies.getJSON(C_API_COOKIE_SESSION);api.ajax.jsonrpc.request(e||a.logoutEndpoint,n||a.logoutMethod,null,"api.cookie.session.endCallbak"),Cookies.remove(C_API_COOKIE_SESSION)},api.cookie.session.endCallbak=function(e){e==C_API_AJAX_SUCCESS?window.location.href=window.location.pathname:api.modal.exception("An unexpected error has occurred. Please try again.")},api.cookie.session.intervalRoutine=function(){var e=Cookies.getJSON(C_API_COOKIE_SESSION);if(e&&!$.active){var n=Math.round((new Date).getTime()/1e3);n>e.expiry?api.cookie.session.end():n>e.expiry-60&&api.cookie.session.confirmExtension()}};